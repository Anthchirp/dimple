
import subprocess
import textwrap


def basic_script(pdb, mtz, center):
    text = """\
           # coot script generated by dimple
           pdb = "%s"
           mtz = "%s"

           #set_nomenclature_errors_on_read("ignore")
           """ % (pdb, mtz)
    if pdb: text += """\
           molecule = read_pdb(pdb)
           """
    if mtz: text += """\
           molecule = read_pdb(pdb)
           map21 = make_and_draw_map(mtz, "2FOFCWT", "PH2FOFCWT", "", 0, 0)
           map11 = make_and_draw_map(mtz, "FOFCWT", "PHFOFCWT", "", 0, 1)
           """
    if center: text += """\
           set_rotation_centre(%g, %g, %g)
           """ % center
    return textwrap.dedent(text)


def generate_r3d(scene_script, filename):
    coot_process = subprocess.Popen(["coot", "--python", "--no-graphics"])
    coot_process.communicate(input=scene_script+
    """\
make_image_raster3d(filename) # adds .r3d
coot_real_exit(0)
""")
